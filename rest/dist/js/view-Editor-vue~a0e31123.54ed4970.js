(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["view-Editor-vue~a0e31123"],{"49d7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("table",{staticClass:"form-group"},[a("tr",[a("th",[t._v("Title:")]),a("th",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.article.title,expression:"article.title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.article.title},on:{input:function(e){e.target.composing||t.$set(t.article,"title",e.target.value)}}})])]),a("br"),a("tr",[a("th",[t._v("Slug:")]),a("th",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.article.slug,expression:"article.slug"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.article.slug},on:{input:function(e){e.target.composing||t.$set(t.article,"slug",e.target.value)}}})])]),a("br"),a("tr",[a("th",[t._v("Category:")]),a("th",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.check_category,expression:"check_category"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.check_category=e.target.multiple?a:a[0]}}},[t._l(t.categories,function(e){return[a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])]})],2)])]),a("br"),a("tr",[a("th",[t._v("Tags:")]),a("th",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.check_tags,expression:"check_tags"}],staticClass:"form-control",attrs:{multiple:"multiple"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.check_tags=e.target.multiple?a:a[0]}}},[t._l(t.tags,function(e){return[a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])]})],2)])])]),a("br"),a("div",[a("mavon-editor",{ref:"md",attrs:{toolbars:t.toolbars},on:{save:t.$save,imgAdd:t.$imgAdd},model:{value:t.article.raw_content,callback:function(e){t.$set(t.article,"raw_content",e)},expression:"article.raw_content"}})],1)])},r=[],o={name:"Editor",props:{fontSize:{type:String,default:"15px"}},data(){return{article:[],tags:[],categories:[],check_category:"",check_tags:[],toolbars:{bold:!0,italic:!0,header:!0,underline:!0,mark:!0,superscript:!0,quote:!0,ol:!0,link:!0,imagelink:!0,help:!0,code:!0,subfield:!0,fullscreen:!0,readmodel:!0,undo:!0,trash:!0,save:!0,navigation:!0}}},mounted(){this.$axios.get("/api/article?slug="+this.$route.params.name,{headers:{Authorization:"Bearer "+this.getCookie("token")}}).then(t=>{this.article=t.data,this.check_category=this.article.category.id,this.check_tags=this.article.tags.map(t=>t.id),document.title="编辑 "+this.article.title+" | BUGLAN"}),this.$axios.get("/api/tags",{headers:{Authorization:"Bearer "+this.getCookie("token")}}).then(t=>{this.tags=t.data}),this.$axios.get("/api/categories",{headers:{Authorization:"Bearer "+this.getCookie("token")}}).then(t=>{this.categories=t.data})},methods:{$save(t,e){this.$axios.put("/api/article",{title:this.article.title,content:t,slug:this.article.slug,id:this.article.id,category_id:this.check_category,tag_ids:this.check_tags},{headers:{Authorization:"Bearer "+this.getCookie("token")}}).then(t=>{200===t.status?alert("保存成功"):alert("保存失败")})},$imgAdd(t,e){let a=new FormData;a.append("image",e),this.$axios({url:"/api/upload_image",method:"post",data:a,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.getCookie("token")}}).then(e=>{200===e.status?this.$refs.md.$img2Url(t,e.data.url):alert("上传图片失败")})}}},s=o,l=a("2877"),n=Object(l["a"])(s,i,r,!1,null,null,null);n.options.__file="Editor.vue";e["default"]=n.exports}}]);